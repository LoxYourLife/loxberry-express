import{r as P,c as g,w as l,Q as ee,o as d,a as t,b as te,d as h,e as R,f as le,g as x,h as ae,i as q,j as v,t as m,k as se,n as oe,R as ne,l as A,m as H,p as re,q as ie,s as c,u as ce,v as ue,x as z,y as Q,z as b,F as D,A as de,B as w,C as B,D as C,E as T,G as me,H as fe,I as j,J as M,K as W,L as _e,M as pe,N as k,O as L,P as ve,S as ye,T as ge,U as he,V as be}from"./vendor.46533dac.js";const Se=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function u(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(n){if(n.ep)return;n.ep=!0;const i=u(n);fetch(n.href,i)}};Se();var I=(s,o)=>{for(const[u,e]of o)s[u]=e;return s};const xe={};function ke(s,o){const u=P("router-view");return d(),g(ee,{view:"hHh lpR fFf",class:"bg-grey-1"},{default:l(()=>[t(te,null,{default:l(()=>[t(u)]),_:1})]),_:1})}var Le=I(xe,[["render",ke]]);const Ve={emits:["disableAutoScroll"],props:{logs:Array,autoScroll:Boolean},setup(s,{emit:o}){const u=h(null),e=h(0),n=async()=>{s.autoScroll===!0&&(await oe(),u.value.scrollTo(s.logs.length-1,"start-force"))};return R([s.logs],n),R(()=>s.autoScroll,r=>{r===!0&&n()}),le(n),{logRef:u,scrollIndex:e,updateScroll:n,onVirtualScroll:({index:r})=>{s.autoScroll===!0&&r<e.value&&o("disableAutoScroll"),e.value=r}}}},we={class:"monospaced bg-grey-3"};function qe(s,o,u,e,n,i){return d(),x("div",we,[t(se,{ref:"logRef",style:{"max-height":"550px"},component:"q-list",items:u.logs,separator:"",onVirtualScroll:e.onVirtualScroll},{default:l(({item:r,index:a})=>[ae(t(q,{key:a,dense:""},{default:l(()=>[v(m(r.date.toLocaleDateString())+" "+m(r.date.toLocaleTimeString())+" "+m(r.message),1)]),_:2},1536),[[ne]])]),_:1},8,["items","onVirtualScroll"])])}var Ae=I(Ve,[["render",qe],["__scopeId","data-v-ff8e5f84"]]);const Qe={components:{Log:Ae},setup(){const s=h({name:null,pid:null,status:"unknown",version:null,memory:{value:0,unit:null},cpu:0,uptime:null,HeapSize:{value:null,unit:null},HeapUsage:{value:null,unit:null},UsedHeapSize:{value:null,unit:null},ActiveRequests:0,ActiveHandles:4,EventLoopLatency:{value:null,unit:null}}),o=h([]),u=h([]),e=h("log"),n=h(!0),i=()=>n.value=!1,r=h(!0),a=(_,f)=>H.exports.get(s.value,_,f||null),F=A(()=>H.exports.isNil(a("pid"))?!1:a("status","stopped")==="online"),J=A(()=>[{name:"Name",telemetry:a("name")},{name:"Version",telemetry:a("version")},{name:"Uptime",telemetry:a("uptime")}]),K=A(()=>[{name:"Heap size",telemetry:a("HeapSize.value")+a("HeapSize.unit")},{name:"Heap Usage",telemetry:a("HeapUsage.value")+a("HeapUsage.unit")},{name:"Used Heap Size",telemetry:a("UsedHeapSize.value")+a("UsedHeapSize.unit")}]),G=A(()=>[{name:"Active requests",telemetry:a("ActiveRequests")},{name:"Active handles",telemetry:a("ActiveHandles")},{name:"Event Loop Latency",telemetry:a("EventLoopLatency.value")+a("EventLoopLatency.unit")}]);let y,O=!1;re(()=>{O=!0,y.close()});const E=async()=>{y=new WebSocket("ws://localhost:3001"),y.onmessage=async _=>{try{const f=JSON.parse(_.data);if(f.telemetry){const V=s.value.status.startsWith("restarting")&&f.telemetry.status==="online",p=s.value.status.startsWith("starting")&&f.telemetry.status==="online",$=s.value.status.startsWith("stopping")&&f.telemetry.status==="stopped";(V||p||$)&&(r.value=!1),s.value=f.telemetry}else if(f.logs){const V=f.logs.map(p=>(p.date=new Date(p.date),p));o.value.push(...V)}else if(f.errorLogs){const V=f.errorLogs.map(p=>(p.date=new Date(p.date),p));u.value.push(...V)}}catch{}},y.onopen=()=>r.value=!1,y.onclose=_=>{y=null,r.value=!0,O||setTimeout(E,5e3)}},U=_=>{H.exports.isNil(y)||(_==="start"?s.value.status="starting ...":_==="stop"?s.value.status="stopping ...":_==="restart"&&(s.value.status="restarting ..."),r.value=!0,y.send(JSON.stringify({command:_})))},X=()=>U("start"),Y=()=>U("stop"),Z=()=>U("restart");return E(),{telemetry:s,isOnline:F,metadata:J,heap:K,requests:G,btnDisabled:r,logs:o,start:X,stop:Y,restart:Z,tab:e,autoScroll:n,disableAutoScroll:i,errorLogs:u}}},S=s=>(_e("data-v-6aa863e2"),s=s(),pe(),s),De={class:"row"},Ue=S(()=>c("div",{class:"col-6 text-h4 self-end"},"Express Telemetry",-1)),He={class:"col-6 text-right q-gutter-sm"},ze={class:"full-width row justify-start items-stretch content-stretch"},Ce={class:"q-px-sm col-md-2 col-sm-4 q-pb-md flex items-stretch content-stretch"},Te=S(()=>c("div",{class:"text-h4"},"Online",-1)),Ie={class:""},Ne={key:1,class:"text-h4"},Oe={class:"col-md-2 col-sm-4 q-px-sm q-pb-md flex items-stretch content-stretch"},Ee=S(()=>c("div",{class:"text-h5"},"CPU Usage",-1)),Pe={class:"col-md-2 col-sm-4 q-px-sm q-pb-md flex items-stretch content-stretch"},Re=S(()=>c("div",{class:"text-h5"},"Memory",-1)),Be={class:"col-md-6 col-sm-12 q-px-sm q-pb-md flex items-stretch content-stretch"},je=S(()=>c("div",{class:"text-h6 q-px-md"},"Metadata",-1)),Me=S(()=>c("div",{class:"text-h6 q-px-md"},"Heap",-1)),We=S(()=>c("div",{class:"text-h6 q-px-md"},"Requests",-1));function Fe(s,o,u,e,n,i){const r=P("Log");return d(),g(ie,{padding:""},{default:l(()=>[c("div",De,[Ue,c("div",He,[e.btnDisabled?(d(),g(ce,{key:0,color:"primary",size:"2em",thickness:10})):ue("",!0),t(z,{disabled:e.btnDisabled,icon:"restart_alt",size:"md",color:"orange-6",label:"Restart Server",onClick:e.restart},null,8,["disabled","onClick"]),e.isOnline?(d(),g(z,{key:1,disabled:e.btnDisabled,icon:"stop",size:"md",color:"red-6",label:"Stop Server",onClick:e.stop},null,8,["disabled","onClick"])):(d(),g(z,{key:2,disabled:e.btnDisabled,icon:"play_arrow",size:"md",color:"light-green-6",label:"Start Server",onClick:e.start},null,8,["disabled","onClick"]))])]),t(Q,{spaced:""}),c("div",ze,[c("div",Ce,[t(w,{class:de(["flex full-width content-center",{"bg-light-green-6":e.isOnline,"bg-red":!e.isOnline}])},{default:l(()=>[t(b,{class:"text-white col-12"},{default:l(()=>[e.isOnline?(d(),x(D,{key:0},[Te,c("div",Ie,"PID "+m(e.telemetry.pid),1)],64)):(d(),x("div",Ne,m(e.telemetry.status),1))]),_:1})]),_:1},8,["class"])]),c("div",Oe,[t(w,{class:"full-width flex justify-center"},{default:l(()=>[t(b,{class:"row justify-center"},{default:l(()=>[Ee,t(B,{min:0,max:100,modelValue:e.telemetry.cpu,"onUpdate:modelValue":o[0]||(o[0]=a=>e.telemetry.cpu=a),"show-value":"",size:"80px",thickness:.22,color:"lime","track-color":"grey-2",class:"text-lime text-bold q-ma-md"},{default:l(()=>[v(m(e.telemetry.cpu)+"%",1)]),_:1},8,["modelValue","thickness"])]),_:1})]),_:1})]),c("div",Pe,[t(w,{class:"full-width flex justify-center"},{default:l(()=>[t(b,{class:"flex justify-center"},{default:l(()=>[Re,t(B,{min:0,max:100,modelValue:e.telemetry.memory.value,"onUpdate:modelValue":o[1]||(o[1]=a=>e.telemetry.memory.value=a),"show-value":"",size:"80px",thickness:.22,color:"lime","track-color":"grey-2",class:"text-lime text-bold q-ma-md"},{default:l(()=>[v(m(e.telemetry.memory.value)+" "+m(e.telemetry.memory.unit),1)]),_:1},8,["modelValue","thickness"])]),_:1})]),_:1})]),c("div",Be,[t(w,{class:"full-width"},{default:l(()=>[t(b,{horizontal:"",class:"flex items-center"},{default:l(()=>[t(b,{class:""},{default:l(()=>[je,t(C,{dense:""},{default:l(()=>[(d(!0),x(D,null,T(e.metadata,a=>(d(),g(q,{key:a.name},{default:l(()=>[t(k,{avatar:""},{default:l(()=>[t(L,null,{default:l(()=>[v(m(a.name),1)]),_:2},1024)]),_:2},1024),t(k,null,{default:l(()=>[t(L,{caption:""},{default:l(()=>[v(m(a.telemetry),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(Q,{vertical:""}),t(b,{class:""},{default:l(()=>[Me,t(C,{dense:""},{default:l(()=>[(d(!0),x(D,null,T(e.heap,a=>(d(),g(q,{key:a.name},{default:l(()=>[t(k,{avatar:""},{default:l(()=>[t(L,null,{default:l(()=>[v(m(a.name),1)]),_:2},1024)]),_:2},1024),t(k,null,{default:l(()=>[t(L,{caption:""},{default:l(()=>[v(m(a.telemetry),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(Q,{vertical:""}),t(b,{class:""},{default:l(()=>[We,t(C,{dense:""},{default:l(()=>[(d(!0),x(D,null,T(e.requests,a=>(d(),g(q,{key:a.name},{default:l(()=>[t(k,{avatar:""},{default:l(()=>[t(L,null,{default:l(()=>[v(m(a.name),1)]),_:2},1024)]),_:2},1024),t(k,null,{default:l(()=>[t(L,{caption:""},{default:l(()=>[v(m(a.telemetry),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})])]),t(w,{class:"q-mx-sm"},{default:l(()=>[t(me,{modelValue:e.tab,"onUpdate:modelValue":o[3]||(o[3]=a=>e.tab=a),dense:"",class:"bg-grey-2","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:l(()=>[t(fe,{modelValue:e.autoScroll,"onUpdate:modelValue":o[2]||(o[2]=a=>e.autoScroll=a),label:"Auto scroll"},null,8,["modelValue"]),t(j,{name:"log",label:"Logs"}),t(j,{name:"error",label:"Error Log"})]),_:1},8,["modelValue"]),t(Q),t(M,{modelValue:e.tab,"onUpdate:modelValue":o[4]||(o[4]=a=>e.tab=a),animated:""},{default:l(()=>[t(W,{name:"log",class:"log"},{default:l(()=>[t(r,{autoScroll:e.autoScroll,logs:e.logs,onDisableAutoScroll:e.disableAutoScroll},null,8,["autoScroll","logs","onDisableAutoScroll"])]),_:1})]),_:1},8,["modelValue"]),t(M,{modelValue:e.tab,"onUpdate:modelValue":o[5]||(o[5]=a=>e.tab=a),animated:""},{default:l(()=>[t(W,{name:"error",class:"log"},{default:l(()=>[t(r,{autoScroll:e.autoScroll,logs:e.errorLogs,onDisableAutoScroll:e.disableAutoScroll},null,8,["autoScroll","logs","onDisableAutoScroll"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}var Je=I(Qe,[["render",Fe],["__scopeId","data-v-6aa863e2"]]),Ke=[{path:"",component:Je}];const N=ve(Le),Ge=ye({history:ge(),routes:Ke});N.use(he,{plugins:{Loading:be}});N.use(Ge);N.mount("#app");
