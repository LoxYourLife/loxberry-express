import{r as T,c as b,o as d,a as g,w as B,b as ae,d as h,e as t,f as s,Q as L,n as j,g as oe,h as P,i,t as f,j as y,k as W,l as ne,m as re,p as Q,q as C,s as ie,u as D,v as V,F as A,x as ce,y as ue,z as U,A as x,B as F,C as H,D as N,E as de,G as me,H as M,I as G,J,K as fe,L as k,M as w,N as _e,O as pe,P as ye,R as ve,S as ge}from"./vendor.6d5be126.js";const he=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&e(r)}).observe(document,{childList:!0,subtree:!0});function m(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function e(n){if(n.ep)return;n.ep=!0;const c=m(n);fetch(n.href,c)}};he();var O=(a,o)=>{for(const[m,e]of o)a[m]=e;return a};const be={};function xe(a,o){const m=T("router-view");return d(),b(m)}var Se=O(be,[["render",xe]]);const ke={emits:["disableAutoScroll"],props:{logs:Array,autoScroll:Boolean},setup(a,{emit:o}){const m=g(null),e=g(0),n=async()=>{a.autoScroll===!0&&(await re(),m.value.scrollTo(a.logs.length-1,"start-force"))};return B([a.logs],n),B(()=>a.autoScroll,u=>{u===!0&&n()}),ae(n),{logRef:m,scrollIndex:e,updateScroll:n,onVirtualScroll:({index:u})=>{a.autoScroll===!0&&u<e.value&&o("disableAutoScroll"),e.value=u},textColor:u=>{if(u==="INFO")return"text-primary";if(u==="ERROR")return"text-negative";if(u==="WARN")return"text-warning";if(u==="DEBUG")return"grey-8"},icon:u=>{if(u==="INFO")return"info";if(u==="ERROR")return"error";if(u==="WARN")return"warning";if(u==="DEBUG")return"bug_report"}}}},we={class:"monospaced bg-grey-3"},Ve={class:"text-weight-thin"},Ae={key:0,class:"pre-line"};function qe(a,o,m,e,n,c){return d(),h("div",we,[t(ne,{ref:"logRef",style:{"max-height":"420px"},component:"q-list",items:m.logs,separator:"",onVirtualScroll:e.onVirtualScroll},{default:s(({item:r,index:l})=>[t(L,{key:l,dense:"",class:j(e.textColor(r.level))},{default:s(()=>[t(oe,{name:e.icon(r.level),size:"sm",class:"q-mr-xs"},null,8,["name"]),t(P,{align:"middle",outline:"",label:r.date,color:"grey-8",class:"q-mr-xs"},null,8,["label"]),t(P,{align:"middle",outline:"",label:r.plugin,color:"grey-8",class:"q-mr-xs"},null,8,["label"]),i("span",Ve,f(r.plugin)+":",1),i("span",null,[y(f(r.message),1),r.error?(d(),h("span",Ae,f(`
${r.error.replaceAll(">","\xA0\xA0")}`),1)):W("",!0)])]),_:2},1032,["class"])]),_:1},8,["items","onVirtualScroll"])])}var Le=O(ke,[["render",qe],["__scopeId","data-v-5ffd27bc"]]);const Qe={components:{Log:Le},setup(){const a=g({name:null,pid:null,status:"unknown",version:null,memory:{value:0,unit:null},cpu:0,uptime:null,HeapSize:{value:null,unit:null},HeapUsage:{value:null,unit:null},UsedHeapSize:{value:null,unit:null},ActiveRequests:0,ActiveHandles:4,EventLoopLatency:{value:null,unit:null}}),o=g([]),m=g([]),e=g("log"),n=g(!0),c=()=>n.value=!1,r=g(!0),l=(_,q)=>C.exports.get(a.value,_,q||null),u=Q(()=>C.exports.isNil(l("pid"))?!1:l("status","stopped")==="online"),K=Q(()=>[{name:"Name",telemetry:l("name")},{name:"Version",telemetry:l("version")},{name:"Uptime",telemetry:l("uptime")}]),X=Q(()=>[{name:"Heap size",telemetry:l("HeapSize.value")+l("HeapSize.unit")},{name:"Heap Usage",telemetry:l("HeapUsage.value")+l("HeapUsage.unit")},{name:"Used Heap Size",telemetry:l("UsedHeapSize.value")+l("UsedHeapSize.unit")}]),Y=Q(()=>[{name:"Active requests",telemetry:l("ActiveRequests")},{name:"Active handles",telemetry:l("ActiveHandles")},{name:"Event Loop Latency",telemetry:l("EventLoopLatency.value")+l("EventLoopLatency.unit")}]);let v,I=!1;ie(()=>{I=!0,v.close()});const E=async()=>{const[_]=window.location.host.split(":");v=new WebSocket(`ws://${_}:3001`),v.onmessage=async q=>{try{const p=JSON.parse(q.data);if(p.telemetry){const te=a.value.status.startsWith("restarting")&&p.telemetry.status==="online",le=a.value.status.startsWith("starting")&&p.telemetry.status==="online",se=a.value.status.startsWith("stopping")&&p.telemetry.status==="stopped";(te||le||se)&&(r.value=!1),a.value=p.telemetry}else p.logs?o.value.push(...p.logs):p.errorLogs&&m.value.push(...p.errorLogs)}catch{}},v.onopen=()=>r.value=!1,v.onclose=q=>{v=null,r.value=!0,I||setTimeout(E,5e3)}},z=_=>{C.exports.isNil(v)||(_==="start"?a.value.status="starting ...":_==="stop"?a.value.status="stopping ...":_==="restart"&&(a.value.status="restarting ..."),r.value=!0,v.send(JSON.stringify({command:_})))},Z=()=>z("start"),$=()=>z("stop"),ee=()=>z("restart");return E(),{telemetry:a,isOnline:u,metadata:K,heap:X,requests:Y,btnDisabled:r,logs:o,start:Z,stop:$,restart:ee,tab:e,autoScroll:n,disableAutoScroll:c,errorLogs:m}}},S=a=>(ce("data-v-68b49b34"),a=a(),ue(),a),Ue={class:"row"},ze=S(()=>i("div",{class:"col-6 text-h4 self-end"},"Express Telemetry",-1)),Ce={class:"col-6 text-right q-gutter-sm"},De={class:"full-width row justify-start items-stretch content-stretch"},He={class:"q-px-sm col-md-2 col-sm-4 q-pb-md flex items-stretch content-stretch"},Ne=S(()=>i("div",{class:"text-h4"},"Online",-1)),Oe={class:""},Re={key:1,class:"text-h4"},Ie={class:"col-md-2 col-sm-4 q-px-sm q-pb-md flex items-stretch content-stretch"},Ee=S(()=>i("div",{class:"text-h5"},"CPU Usage",-1)),Te={class:"col-md-2 col-sm-4 q-px-sm q-pb-md flex items-stretch content-stretch"},Be=S(()=>i("div",{class:"text-h5"},"Memory",-1)),je={class:"col-md-6 col-sm-12 q-px-sm q-pb-md flex items-stretch content-stretch"},Pe=S(()=>i("div",{class:"text-h6 q-px-md"},"Metadata",-1)),We=S(()=>i("div",{class:"text-h6 q-px-md"},"Heap",-1)),Fe=S(()=>i("div",{class:"text-h6 q-px-md"},"Requests",-1));function Me(a,o,m,e,n,c){const r=T("Log");return d(),h(A,null,[i("div",Ue,[ze,i("div",Ce,[e.btnDisabled?(d(),b(fe,{key:0,color:"primary",size:"2em",thickness:10})):W("",!0),t(D,{disabled:e.btnDisabled,icon:"restart_alt",size:"md",color:"orange-6",label:"Restart Server",onClick:e.restart},null,8,["disabled","onClick"]),e.isOnline?(d(),b(D,{key:1,disabled:e.btnDisabled,icon:"stop",size:"md",color:"red-6",label:"Stop Server",onClick:e.stop},null,8,["disabled","onClick"])):(d(),b(D,{key:2,disabled:e.btnDisabled,icon:"play_arrow",size:"md",color:"light-green-6",label:"Start Server",onClick:e.start},null,8,["disabled","onClick"]))])]),t(U,{spaced:""}),i("div",De,[i("div",He,[t(V,{class:j(["flex full-width content-center",{"bg-light-green-6":e.isOnline,"bg-red":!e.isOnline}])},{default:s(()=>[t(x,{class:"text-white col-12"},{default:s(()=>[e.isOnline?(d(),h(A,{key:0},[Ne,i("div",Oe,"PID "+f(e.telemetry.pid),1)],64)):(d(),h("div",Re,f(e.telemetry.status),1))]),_:1})]),_:1},8,["class"])]),i("div",Ie,[t(V,{class:"full-width flex justify-center"},{default:s(()=>[t(x,{class:"row justify-center"},{default:s(()=>[Ee,t(F,{readonly:"",min:0,max:100,modelValue:e.telemetry.cpu,"onUpdate:modelValue":o[0]||(o[0]=l=>e.telemetry.cpu=l),"show-value":"",size:"80px",thickness:.22,color:"lime","track-color":"grey-2",class:"text-lime text-bold q-ma-md"},{default:s(()=>[y(f(e.telemetry.cpu)+"%",1)]),_:1},8,["modelValue","thickness"])]),_:1})]),_:1})]),i("div",Te,[t(V,{class:"full-width flex justify-center"},{default:s(()=>[t(x,{class:"flex justify-center"},{default:s(()=>[Be,t(F,{readonly:"",min:0,max:100,modelValue:e.telemetry.memory.value,"onUpdate:modelValue":o[1]||(o[1]=l=>e.telemetry.memory.value=l),"show-value":"",size:"80px",thickness:.22,color:"lime","track-color":"grey-2",class:"text-lime text-bold q-ma-md"},{default:s(()=>[y(f(e.telemetry.memory.value)+" "+f(e.telemetry.memory.unit),1)]),_:1},8,["modelValue","thickness"])]),_:1})]),_:1})]),i("div",je,[t(V,{class:"full-width"},{default:s(()=>[t(x,{horizontal:"",class:"flex items-center"},{default:s(()=>[t(x,{class:""},{default:s(()=>[Pe,t(H,{dense:""},{default:s(()=>[(d(!0),h(A,null,N(e.metadata,l=>(d(),b(L,{key:l.name},{default:s(()=>[t(k,{avatar:""},{default:s(()=>[t(w,null,{default:s(()=>[y(f(l.name),1)]),_:2},1024)]),_:2},1024),t(k,null,{default:s(()=>[t(w,{caption:""},{default:s(()=>[y(f(l.telemetry),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(U,{vertical:""}),t(x,{class:""},{default:s(()=>[We,t(H,{dense:""},{default:s(()=>[(d(!0),h(A,null,N(e.heap,l=>(d(),b(L,{key:l.name},{default:s(()=>[t(k,{avatar:""},{default:s(()=>[t(w,null,{default:s(()=>[y(f(l.name),1)]),_:2},1024)]),_:2},1024),t(k,null,{default:s(()=>[t(w,{caption:""},{default:s(()=>[y(f(l.telemetry),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),t(U,{vertical:""}),t(x,{class:""},{default:s(()=>[Fe,t(H,{dense:""},{default:s(()=>[(d(!0),h(A,null,N(e.requests,l=>(d(),b(L,{key:l.name},{default:s(()=>[t(k,{avatar:""},{default:s(()=>[t(w,null,{default:s(()=>[y(f(l.name),1)]),_:2},1024)]),_:2},1024),t(k,null,{default:s(()=>[t(w,{caption:""},{default:s(()=>[y(f(l.telemetry),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})])]),t(V,{class:"q-mx-sm"},{default:s(()=>[t(de,{modelValue:e.tab,"onUpdate:modelValue":o[3]||(o[3]=l=>e.tab=l),dense:"",class:"bg-grey-2","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:s(()=>[t(me,{modelValue:e.autoScroll,"onUpdate:modelValue":o[2]||(o[2]=l=>e.autoScroll=l),label:"Auto scroll"},null,8,["modelValue"]),t(M,{name:"log",label:"Logs"}),t(M,{name:"error",label:"Error Log"})]),_:1},8,["modelValue"]),t(U),t(G,{modelValue:e.tab,"onUpdate:modelValue":o[4]||(o[4]=l=>e.tab=l),animated:""},{default:s(()=>[t(J,{name:"log",class:"log"},{default:s(()=>[t(r,{autoScroll:e.autoScroll,logs:e.logs,onDisableAutoScroll:e.disableAutoScroll},null,8,["autoScroll","logs","onDisableAutoScroll"])]),_:1})]),_:1},8,["modelValue"]),t(G,{modelValue:e.tab,"onUpdate:modelValue":o[5]||(o[5]=l=>e.tab=l),animated:""},{default:s(()=>[t(J,{name:"error",class:"log"},{default:s(()=>[t(r,{autoScroll:e.autoScroll,logs:e.errorLogs,onDisableAutoScroll:e.disableAutoScroll},null,8,["autoScroll","logs","onDisableAutoScroll"])]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}var Ge=O(Qe,[["render",Me],["__scopeId","data-v-68b49b34"]]),Je=[{path:"",component:Ge}];const R=_e(Se),Ke=pe({history:ye(),routes:Je});R.use(ve,{plugins:{Loading:ge}});R.use(Ke);R.mount("#app");
